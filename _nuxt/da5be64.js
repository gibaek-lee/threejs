(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{445:function(e,n,t){"use strict";t.d(n,"a",(function(){return d}));t(70);var o=t(125),r=t(443),c=t(451),l=t(448);function d(e){e.context;var n=e.isOrbitControl,t=void 0!==n&&n,d=Object(o.e)(null),h=Object(o.e)(null),m=Object(o.e)(null),v=Object(o.e)(null),w=Object(o.e)(null),canvas=Object(o.e)(void 0),f=Object(o.e)(null),x=Object(o.e)(null),C=Object(o.e)(null),A=Object(o.a)((function(){return{width:window.innerWidth,height:window.innerHeight}})),k=Object(o.a)((function(){return!!h.value&&!!f.value&&!!v.value}));Object(o.g)(canvas,(function(){O(),P()})),Object(o.d)((function(){window.addEventListener("resize",(function(){A.value.width=window.innerWidth,A.value.height=window.innerHeight,v.value&&(v.value.aspect=A.value.width/A.value.height,v.value.updateProjectionMatrix()),f.value&&(f.value.setSize(A.value.width,A.value.height),f.value.setPixelRatio(Math.min(window.devicePixelRatio,2)))}))}));var O=function(){h.value=new r.qb,m.value=new r.h(1),m.value.position.set(2.01,.01,2.01),v.value=new r.fb(75,A.value.width/A.value.height,.1,200),v.value.position.set(4,20,60),w.value=new r.Ab,f.value=new r.Gb({canvas:canvas.value}),f.value.setSize(A.value.width,A.value.height),f.value.setPixelRatio(Math.min(window.devicePixelRatio,2)),f.value.setClearColor("#262837"),t&&(x.value=new l.a(v.value,canvas.value),x.value.enableDamping=!0),C.value=new r.p},P=function(){d.value=new c.a({closed:!1,width:350}),d.value.parentSelector="div.dg.ac"};return{setCanvas:function(e){var n=e.vm,t=e.selectorCanvasId,o=void 0===t?"":t,r="canvas.webgl";o&&(r+=".".concat(o)),canvas.value=n.$el.querySelector(r)||void 0},registerRenderTickCanvas:function(e){var n=0,t=window.setInterval((function(){if(k.value)return e(),void window.clearInterval(t);n+=1,console.log("waiting UseWebgl init...",n),n>60&&(window.clearInterval(t),console.error("failed to init UseWebgl"))}),100)},canvas:canvas,gui:d,scene:h,renderer:f,axesHelper:m,cameraOrbit:v,orbitControl:x,windowSizes:A,clock:C,textureLoader:w}}},447:function(e,n,t){"use strict";t.d(n,"c",(function(){return r})),t.d(n,"a",(function(){return c})),t.d(n,"b",(function(){return l}));t(9);var o=t(443);function r(e){var n=e.scene,t=e.renderer,r=e.recieveMesh,c=e.castMeshs,l=e.light,d=e.isUseCameraHelper;t.shadowMap.enabled=!0,t.shadowMap.type=o.eb,r.receiveShadow=!0,c.forEach((function(e){e.castShadow=!0})),l.castShadow=!0,l.shadow.mapSize.width=1024,l.shadow.mapSize.height=1024,l.shadow.camera.near=1,l.shadow.camera.far=10;var h=null;d&&((h=new o.n(l.shadow.camera)).visible=!0,n.add(h));return{toggleVisiblePointLightCameraHelper:function(){h&&(h.visible=!h.visible)}}}function c(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{color:16777215,intensity:.3},t=new o.a(n.color,n.intensity);return e.add(t),{ambientLight:t}}function l(e){var n=e.scene,t=new o.hb(16777215,.3);return t.position.set(1,1,1),n.add(t),{pointLight:t}}},463:function(e,n,t){var content=t(488);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,t(21).default)("6c8be506",content,!0,{sourceMap:!1})},487:function(e,n,t){"use strict";t(463)},488:function(e,n,t){var o=t(20)(!1);o.push([e.i,".animate-model-import-container[data-v-2a06622c]{height:100%}.animate-model-import-container .col-controls[data-v-2a06622c]{flex-grow:unset}.animate-model-import-container .col-controls .animation-change-box>div[data-v-2a06622c]{width:50px;height:50px;margin-bottom:10px;word-break:break-all;padding:5px;font-size:12px;text-align:center}.animate-model-import-container .col-controls .animation-change-box>div[data-v-2a06622c]:hover{cursor:pointer}.animate-model-import-container .col-controls .animation-change-box__survey[data-v-2a06622c]{background-color:#00f}.animate-model-import-container .col-controls .animation-change-box__walk[data-v-2a06622c]{background-color:green}.animate-model-import-container .col-controls .animation-change-box__run[data-v-2a06622c]{background-color:orange}.animate-model-import-container .col-controls .animation-change-box__stop[data-v-2a06622c]{background-color:red}.animate-model-import-container .col-canvas[data-v-2a06622c]{flex-grow:inherit;position:relative}",""]),e.exports=o},540:function(e,n,t){"use strict";t.r(n);t(27),t(31);var o,r=t(2),c=t(443),l=t(445),d=t(447),h=t(3),m=(t(19),t(485)),v=t(486);t(9),t(164),t(30);function w(e){var n,t=e.loaderType,r=void 0===t?o.DEFAULT:t,l=e.targetModelPath,d=void 0===l?"":l,w=e.successCallback,f=void 0===w?function(){}:w;(n={},Object(h.a)(n,o.DEFAULT,(function(){return new Promise((function(e){e(new m.a)}))})),Object(h.a)(n,o.DRACO,(function(){return new Promise((function(e){var n=new m.a,t=new v.a;n.setDRACOLoader(t),e(n)}))})),Object(h.a)(n,o.BINARY,(function(){return new Promise((function(e){return e(!1)}))})),Object(h.a)(n,o.EMBEDDED,(function(){return new Promise((function(e){return e(!1)}))})),n)[r]().then((function(e){e.load(d,(function(e){console.log("model load success",e);var n=null,t=null;e.animations.length>0&&(t=function(e){var n=e.mixer,t=e.animations,o={},r=[];t.forEach((function(e){var t=e.name;Object.assign(o,Object(h.a)({},t,(function(){r.forEach((function(data){data.name!==t&&data.action.stop()}));var o=null;r.every((function(a){return a.name!==t}))&&(o=n.clipAction(e),r.push({name:t,action:o}));var c=r.find((function(a){return a.name===t}));c&&c.action.play()})))})),Object.assign(o,{stop:function(){r.forEach((function(data){data.action.stop()}))}});var c=function(e){var n=t.reduce((function(a,e){return a.concat([e.name])}),[])[Number(e.key)-1];(o[n]||o.stop)()};return window.addEventListener("keydown",c),{invokeClipAction:o,destroyClipEvent:function(){window.removeEventListener("keydown",c)}}}({mixer:n=new c.c(e.scene),animations:e.animations})),f({gltf:e,animationMixer:n,changeAnimation:t})}))}))}!function(e){e.DEFAULT="glTF",e.DRACO="Draco",e.BINARY="Binary",e.EMBEDDED="Embedded"}(o||(o={}));var f=Object(r.d)({setup:function(e,n){var t=Object(l.a)({context:n,isOrbitControl:!0});return{setCanvas:t.setCanvas,registerRenderTickCanvas:t.registerRenderTickCanvas,gui:t.gui,scene:t.scene,renderer:t.renderer,axesHelper:t.axesHelper,cameraOrbit:t.cameraOrbit,orbitControl:t.orbitControl,windowSizes:t.windowSizes,clock:t.clock}},data:function(){return{idAnimationFrame:null,prevTime:0,selectorCanvasWrap:"animate-model-import",guiParams:{},ambientLight:null,basePlane:null,iGLTF:null,iAnimationMixer:null,changeAnimation:null}},watch:{guiParams:{deep:!0,handler:function(e){var n=e.intensityAmbientLight,t=e.scalePlane,o=e.scaleFox;n&&(this.ambientLight.intensity=n),t&&this.basePlane.scale.set(t,t,1),this.iGLTF&&o&&this.iGLTF.scene.scale.set(o,o,o)}}},mounted:function(){var e=this;this.setCanvas({vm:this}),this.registerRenderTickCanvas((function(){e.initUtils(),e.setStyleDatGui(),e.tick()}))},beforeDestroy:function(){window.cancelAnimationFrame(this.idAnimationFrame),document.querySelector(this.gui.parentSelector).appendChild(this.gui.domElement),this.gui.destroy(),this.changeAnimation.destroyClipEvent()},methods:{initUtils:function(){var e=this;this.guiParams=Object.assign({intensityAmbientLight:.7,scalePlane:3,scaleFox:.1,timeSpeed:2},{}),this.gui.add(this.guiParams,"intensityAmbientLight").min(0).max(1).step(.01),this.gui.add(this.guiParams,"scalePlane").min(1).max(10).step(1),this.gui.add(this.guiParams,"scaleFox").min(.01).max(.5).step(.001),this.gui.add(this.guiParams,"timeSpeed").min(1).max(10).step(.1);var n=Object(d.a)(this.scene,{intensity:this.guiParams.intensityAmbientLight}).ambientLight;this.ambientLight=n;this.basePlane=this.makeBasePlane(30),this.scene.add(this.basePlane),w({loaderType:o.DEFAULT,targetModelPath:"/threejs/models/Fox/glTF/Fox.gltf",successCallback:function(n){var t=n.gltf,o=n.animationMixer,r=n.changeAnimation;e.iGLTF=t,e.iAnimationMixer=o,e.changeAnimation=r;var c=e.guiParams.scaleFox;t.scene.scale.set(c,c,c),t.scene.rotateY(Math.PI/4),e.scene.add(t.scene)}}),this.cameraOrbit.position.set(0,5,20)},tick:function(){var e=this.clock.getElapsedTime(),n=e-this.prevTime;this.prevTime=e,this.orbitControl.update(),this.iAnimationMixer&&this.iAnimationMixer.update(n*this.guiParams.timeSpeed),this.renderer.render(this.scene,this.cameraOrbit),this.idAnimationFrame=window.requestAnimationFrame(this.tick)},setStyleDatGui:function(){this.gui.domElement.style.cssText+="position: absolute; right: 0px; top: 0px;",this.$el.querySelector(".".concat(this.selectorCanvasWrap)).appendChild(this.gui.domElement)},makeBasePlane:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,n=10,t=new c.gb(e,e,n,n),o=new c.W({roughness:.7,color:16776960,wireframe:!0}),r=new c.T(t,o);return r.rotation.x=.5*-Math.PI,r.position.y=0,r},clickAniBtn:function(e){var n=this.iGLTF.animations.reduce((function(a,e){return a.concat([e.name])}),[])[e-1];(this.changeAnimation.invokeClipAction[n]||this.changeAnimation.invokeClipAction.stop)()}}}),x=(t(487),t(46)),C=t(58),A=t.n(C),k=t(454),O=t(453),component=Object(x.a)(f,(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("v-row",{class:e.selectorCanvasWrap+"-container"},[t("v-col",{staticClass:"col-controls"},[t("div",{staticClass:"animation-change-box"},e._l(["survey","walk","run","stop"],(function(n,o){return t("div",{key:n+"_"+o,class:"animation-change-box__"+n,on:{click:function(n){return e.clickAniBtn(o+1)}}},[e._v("\n        run ani "+e._s(n)+"\n      ")])})),0)]),e._v(" "),t("v-col",{staticClass:"col-canvas",class:e.selectorCanvasWrap},[t("canvas",{staticClass:"webgl"})])],1)}),[],!1,null,"2a06622c",null);n.default=component.exports;A()(component,{VCol:k.a,VRow:O.a})}}]);