(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{445:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));n(70);var r=n(125),o=n(443),c=n(449),l=n(448);function d(e){e.context;var t=e.isOrbitControl,n=void 0!==t&&t,d=e.isPhysicallyCorrectLight,h=void 0!==d&&d,f=Object(r.e)(null),v=Object(r.e)(null),w=Object(r.e)(null),m=Object(r.e)(null),y=Object(r.e)(null),canvas=Object(r.e)(void 0),O=Object(r.e)(null),j=Object(r.e)(null),k=Object(r.e)(null),S=Object(r.a)((function(){return{width:window.innerWidth,height:window.innerHeight}})),C=Object(r.a)((function(){return!!v.value&&!!O.value&&!!m.value}));Object(r.g)(canvas,(function(){W(),x()})),Object(r.d)((function(){window.addEventListener("resize",(function(){S.value.width=window.innerWidth,S.value.height=window.innerHeight,m.value&&(m.value.aspect=S.value.width/S.value.height,m.value.updateProjectionMatrix()),O.value&&(O.value.setSize(S.value.width,S.value.height),O.value.setPixelRatio(Math.min(window.devicePixelRatio,2)))}))}));var W=function(){v.value=new o.wb,w.value=new o.i(1),w.value.position.set(2.01,.01,2.01),m.value=new o.kb(75,S.value.width/S.value.height,.1,200),m.value.position.set(4,20,60),y.value=new o.Gb,O.value=new o.Mb({canvas:canvas.value,antialias:!0}),O.value.setSize(S.value.width,S.value.height),O.value.setPixelRatio(Math.min(window.devicePixelRatio,2)),O.value.setClearColor("#262837"),O.value.physicallyCorrectLights=h,n&&(j.value=new l.a(m.value,canvas.value),j.value.enableDamping=!0),k.value=new o.r},x=function(){f.value=new c.a({closed:!1,width:350}),f.value.parentSelector="div.dg.ac"};return{setCanvas:function(e){var t=e.vm,n=e.selectorCanvasId,r=void 0===n?"":n,o="canvas.webgl";r&&(o+=".".concat(r)),canvas.value=t.$el.querySelector(o)||void 0},registerRenderTickCanvas:function(e){var t=0,n=window.setInterval((function(){if(C.value)return e(),void window.clearInterval(n);t+=1,console.log("waiting UseWebgl init...",t),t>60&&(window.clearInterval(n),console.error("failed to init UseWebgl"))}),100)},canvas:canvas,gui:f,scene:v,renderer:O,axesHelper:w,cameraOrbit:m,orbitControl:j,windowSizes:S,clock:k,textureLoader:y}}},447:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d}));var r,o=n(3),c=n(443);function l(e,t){var n,l=t.type,d=void 0===l?r.ambient:l,h=t.color,f=void 0===h?16777215:h,v=t.intensity,w=void 0===v?.3:v,m=t.position3,y=void 0===m?new c.Kb(0,0,0):m,O=(n={},Object(o.a)(n,r.ambient,(function(){return new c.b(f,w)})),Object(o.a)(n,r.directional,(function(){return new c.v(f,w)})),Object(o.a)(n,r.point,(function(){return new c.mb(f,w)})),n)[d||r.ambient]();return O.position.set(y.x,y.y,y.z),e.add(O),O}!function(e){e[e.ambient=0]="ambient",e[e.directional=1]="directional",e[e.point=2]="point"}(r||(r={}));n(9);function d(e){var t=e.scene,n=e.renderer,r=e.recieveMesh,o=e.castMeshs,l=e.light,d=e.isUseCameraHelper;n.shadowMap.enabled=!0,n.shadowMap.type=c.jb,r&&(r.receiveShadow=!0),o.forEach((function(e){"Group"===e.type?e.children.forEach((function(e){e.castShadow=!0,e.receiveShadow=!0})):e.castShadow=!0})),l.castShadow=!0,l.shadow.mapSize.width=1024,l.shadow.mapSize.height=1024,l.shadow.camera.near=1,l.shadow.camera.far=60,"OrthographicCamera"===l.shadow.camera.type&&(l.shadow.camera.top=10,l.shadow.camera.right=10,l.shadow.camera.bottom=-10,l.shadow.camera.left=-10),l.shadow.normalBias=.05;var h=null;d&&((h=new c.o(l.shadow.camera)).visible=!0,t.add(h));return{toggleVisiblePointLightCameraHelper:function(){h&&(h.visible=!h.visible)}}}},453:function(e,t,n){"use strict";n(8),n(10),n(15),n(16);var r=n(3),o=(n(57),n(75),n(27),n(11),n(36),n(63),n(269),n(19),n(39),n(270),n(271),n(272),n(273),n(274),n(275),n(276),n(277),n(278),n(279),n(280),n(281),n(282),n(45),n(9),n(268),n(0)),c=n(88),l=n(1);function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function h(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f=["sm","md","lg","xl"],v=["start","end","center"];function w(e,t){return f.reduce((function(n,r){return n[e+Object(l.r)(r)]=t(),n}),{})}var m=function(e){return[].concat(v,["baseline","stretch"]).includes(e)},y=w("align",(function(){return{type:String,default:null,validator:m}})),O=function(e){return[].concat(v,["space-between","space-around"]).includes(e)},j=w("justify",(function(){return{type:String,default:null,validator:O}})),k=function(e){return[].concat(v,["space-between","space-around","stretch"]).includes(e)},S=w("alignContent",(function(){return{type:String,default:null,validator:k}})),C={align:Object.keys(y),justify:Object.keys(j),alignContent:Object.keys(S)},W={align:"align",justify:"justify",alignContent:"align-content"};function x(e,t,n){var r=W[e];if(null!=n){if(t){var o=t.replace(e,"");r+="-".concat(o)}return(r+="-".concat(n)).toLowerCase()}}var P=new Map;t.a=o.default.extend({name:"v-row",functional:!0,props:h(h(h({tag:{type:String,default:"div"},dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:m}},y),{},{justify:{type:String,default:null,validator:O}},j),{},{alignContent:{type:String,default:null,validator:k}},S),render:function(e,t){var n=t.props,data=t.data,o=t.children,l="";for(var d in n)l+=String(n[d]);var h=P.get(l);return h||function(){var e,t;for(t in h=[],C)C[t].forEach((function(e){var r=n[e],o=x(t,e,r);o&&h.push(o)}));h.push((e={"no-gutters":n.noGutters,"row--dense":n.dense},Object(r.a)(e,"align-".concat(n.align),n.align),Object(r.a)(e,"justify-".concat(n.justify),n.justify),Object(r.a)(e,"align-content-".concat(n.alignContent),n.alignContent),e)),P.set(l,h)}(),e(n.tag,Object(c.a)(data,{staticClass:"row",class:h}),o)}})},454:function(e,t,n){"use strict";n(8),n(10),n(15),n(16);var r=n(3),o=(n(30),n(11),n(36),n(63),n(269),n(19),n(39),n(270),n(271),n(272),n(273),n(274),n(275),n(276),n(277),n(278),n(279),n(280),n(281),n(282),n(45),n(57),n(9),n(71),n(268),n(0)),c=n(88),l=n(1);function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function h(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f=["sm","md","lg","xl"],v=f.reduce((function(e,t){return e[t]={type:[Boolean,String,Number],default:!1},e}),{}),w=f.reduce((function(e,t){return e["offset"+Object(l.r)(t)]={type:[String,Number],default:null},e}),{}),m=f.reduce((function(e,t){return e["order"+Object(l.r)(t)]={type:[String,Number],default:null},e}),{}),y={col:Object.keys(v),offset:Object.keys(w),order:Object.keys(m)};function O(e,t,n){var r=e;if(null!=n&&!1!==n){if(t){var o=t.replace(e,"");r+="-".concat(o)}return"col"!==e||""!==n&&!0!==n?(r+="-".concat(n)).toLowerCase():r.toLowerCase()}}var j=new Map;t.a=o.default.extend({name:"v-col",functional:!0,props:h(h(h(h({cols:{type:[Boolean,String,Number],default:!1}},v),{},{offset:{type:[String,Number],default:null}},w),{},{order:{type:[String,Number],default:null}},m),{},{alignSelf:{type:String,default:null,validator:function(e){return["auto","start","end","center","baseline","stretch"].includes(e)}},tag:{type:String,default:"div"}}),render:function(e,t){var n=t.props,data=t.data,o=t.children,l=(t.parent,"");for(var d in n)l+=String(n[d]);var h=j.get(l);return h||function(){var e,t;for(t in h=[],y)y[t].forEach((function(e){var r=n[e],o=O(t,e,r);o&&h.push(o)}));var o=h.some((function(e){return e.startsWith("col-")}));h.push((e={col:!o||!n.cols},Object(r.a)(e,"col-".concat(n.cols),n.cols),Object(r.a)(e,"offset-".concat(n.offset),n.offset),Object(r.a)(e,"order-".concat(n.order),n.order),Object(r.a)(e,"align-self-".concat(n.alignSelf),n.alignSelf),e)),j.set(l,h)}(),e(n.tag,Object(c.a)(data,{class:h}),o)}})},476:function(e,t,n){var content=n(536);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(21).default)("9b3b6fac",content,!0,{sourceMap:!1})},535:function(e,t,n){"use strict";n(476)},536:function(e,t,n){var r=n(20)(!1);r.push([e.i,".physics-engine-with-web-worker-container[data-v-24a1fa92]{height:100%}.physics-engine-with-web-worker-container .col-controls[data-v-24a1fa92]{flex-grow:unset}.physics-engine-with-web-worker-container .col-controls .color-change-box>div[data-v-24a1fa92]{width:50px;height:50px}.physics-engine-with-web-worker-container .col-controls .color-change-box__red[data-v-24a1fa92]{color:red}.physics-engine-with-web-worker-container .col-controls .color-change-box__green[data-v-24a1fa92]{color:green}.physics-engine-with-web-worker-container .col-controls .color-change-box__blue[data-v-24a1fa92]{color:#00f}.physics-engine-with-web-worker-container .col-canvas[data-v-24a1fa92]{flex-grow:inherit;position:relative}",""]),e.exports=r},543:function(e,t,n){"use strict";n.r(t);n(10),n(9),n(70),n(27);var r=n(2),o=n(443);n(19);var c=n(445),l=n(33),d=n(49),h=(n(39),n(45),n(195),n(502),n(504),n(509),n(511),n(512),n(513),n(515),n(516),n(517),n(518),n(519),n(520),n(521),n(522),n(524),n(525),n(526),n(527),n(528),n(529),n(530),n(531),n(532),n(533),n(534),function(){function e(t){var n=t.N,dt=t.dt,r=t.physicsLibUrl,o=t.physicsWorldScript;Object(l.a)(this,e),this.N=n,this.dt=dt,this.sendTime=0,this.physicsLibUrl=r,this.physicsWorldScript=o,this.messageFromWorker={isWorldReady:!1,positions:void 0,quaternions:void 0},this.worker=new Worker(""),this.init()}return Object(d.a)(e,[{key:"init",value:function(){var e=this;this.createWorkerTagScript(),this.createWorker().then((function(){e.worker.postMessage(Object.assign({},{physicsLibUrl:e.physicsLibUrl})),e.worker.onmessage=function(t){var n=t.data,r=n.isWorldReady,o=n.positions,c=n.quaternions;e.messageFromWorker.isWorldReady=r,e.messageFromWorker.positions=o,e.messageFromWorker.quaternions=c}})).catch((function(e){window.console.log(e.message)}))}},{key:"createWorkerTagScript",value:function(){var e=document.createElement("script");e.setAttribute("id","worker"),e.setAttribute("type","javascript/worker"),e.text=this.physicsWorldScript,e.onload=function(){window.console.log("tagScript load success")},document.body.insertBefore(e,document.body.firstChild)}},{key:"createWorker",value:function(){var e=this;return new Promise((function(t,n){var r=document.querySelector("#worker");if(r){e.worker.terminate();var o=new Blob([r.textContent],{type:"text/javascript"}),c=new Worker(window.URL.createObjectURL(o));e.worker=c,t(!0)}else n(new Error("element id worker was not found"))}))}},{key:"sendDataToWorker",value:function(data){this.sendTime=Date.now();var t=data.physicsObjects.filter((function(e){return"SphereGeometry"===e})).length,n=new Float32Array(3*t),r=new Float32Array(4*t),o=1/data.timeSinceLastCalled;o-1/this.dt>e.THRESHOLD_FPS?window.console.log("Drop message. FPS difference: ",o-1/this.dt):this.messageFromWorker.isWorldReady?this.worker.postMessage(Object.assign({},{N:this.N,dt:this.dt,positions:n,quaternions:r},data),[n.buffer,r.buffer]):console.log("Phyics world is not ready")}}]),e}());h.THRESHOLD_FPS=80;var f=n(447),v=Object(r.d)({setup:function(e,t){var n=Object(c.a)({context:t,isOrbitControl:!0});return{setCanvas:n.setCanvas,registerRenderTickCanvas:n.registerRenderTickCanvas,gui:n.gui,scene:n.scene,renderer:n.renderer,axesHelper:n.axesHelper,cameraOrbit:n.cameraOrbit,orbitControl:n.orbitControl,windowSizes:n.windowSizes,clock:n.clock}},data:function(){return{idAnimationFrame:null,selectorCanvasWrap:"physics-engine-with-web-worker",iComposeWorker:null,oldElapsedTime:0,deltaTime:0,physicsObjects:[],debugObject:{}}},head:function(){return{title:"Physics Engine with Web-Worker",meta:[{hid:"description",name:"description",content:"Physics Engine(CANNON.js) test using Web-Worker API"}]}},computed:{sphereMeshes:function(){return this.physicsObjects.filter((function(e){return"SphereGeometry"===e.geometry.type}))},messageFromWorker:function(){return this.iComposeWorker?this.iComposeWorker.messageFromWorker:{}}},watch:{messageFromWorker:{deep:!0,handler:function(e){var t=this,n=e.positions,r=e.quaternions;this.sphereMeshes.forEach((function(e,o){n&&e.position.set(n[3*o+0],n[3*o+1],n[3*o+2]),r&&e.quaternion.set(r[4*o+0],r[4*o+1],r[4*o+2],r[4*o+3]),t.scene.children.every((function(t){return t.uuid!==e.uuid}))&&t.scene.add(e)}))}}},mounted:function(){var e=this;this.setCanvas({vm:this}),this.registerRenderTickCanvas((function(){e.initUtils(),e.initWorkerPhysics(),e.setStyleDatGui(),e.tick();var t=window.setInterval((function(){e.physicsObjects.filter((function(e){return"SphereGeometry"===e.geometry.type})).length>=100?window.clearInterval(t):e.createSphereMesh()}),100)}))},beforeDestroy:function(){window.cancelAnimationFrame(this.idAnimationFrame),this.iComposeWorker.worker.terminate(),document.querySelector(this.gui.parentSelector).appendChild(this.gui.domElement),this.gui.destroy()},methods:{createSphereMesh:function(){var e=new o.X(new o.Ab(.5,32,32),new o.ab({metalness:.3,roughness:.4}));e.castShadow=!0,this.physicsObjects.push(e)},initUtils:function(){var e=new o.X(new o.lb(100,100),new o.ab({color:"#777777",metalness:.3,roughness:.4}));e.rotation.x=.5*-Math.PI,this.scene.add(e),this.physicsObjects.push(e),this.debugObject.createSphereMesh=this.createSphereMesh,this.gui.add(this.debugObject,"createSphereMesh"),this.cameraOrbit.position.set(0,3,8);Object(f.b)(this.scene,{type:f.a.ambient,intensity:.7});var t=Object(f.b)(this.scene,{type:f.a.point,position3:new o.Kb(0,5,0)});Object(f.c)({scene:this.scene,renderer:this.renderer,recieveMesh:e,castMeshs:this.physicsObjects,light:t,isUseCameraHelper:!0}).toggleVisiblePointLightCameraHelper},initWorkerPhysics:function(){var e,t,n=this,r=document.location.origin;(e={url:"".concat(r,"/threejs/cannon/business/drop-bodies.js")},t=e.url,new Promise((function(e){var n=new XMLHttpRequest;n.open("GET",t,!1),n.onreadystatechange=function(){4===n.readyState&&(200!==n.status&&0!==n.status||e(n.responseText))},n.send(null)}))).then((function(e){var t,o,dt,c,l,d=(t={N:0,dt:1/60,physicsLibUrl:"".concat(r,"/threejs/cannon/build/cannon.js"),physicsWorldScript:e},o=t.N,dt=t.dt,c=t.physicsLibUrl,l=t.physicsWorldScript,{iComposeWorker:new h({N:o,dt:dt,physicsLibUrl:c,physicsWorldScript:l})}).iComposeWorker;n.iComposeWorker=d}))},sendDataToWorker:function(e){var t=this;if(null!==this.iComposeWorker){var n=1e3*this.iComposeWorker.dt-(Date.now()-this.iComposeWorker.sendTime);n<0&&(n=0),window.setTimeout((function(){t.iComposeWorker.sendDataToWorker({action:"step",timeSinceLastCalled:e,maxSubSteps:3,physicsObjects:t.physicsObjects.reduce((function(a,e){return a.concat(e.geometry.type)}),[])})}),n)}},tick:function(){var e=this.clock.getElapsedTime();this.deltaTime=e-this.oldElapsedTime,this.oldElapsedTime=e,this.physicsObjects.length>0&&this.sendDataToWorker(this.deltaTime),this.renderer.render(this.scene,this.cameraOrbit),this.orbitControl.update(),this.idAnimationFrame=window.requestAnimationFrame(this.tick)},setStyleDatGui:function(){this.gui.domElement.style.cssText+="position: absolute; right: 0px; top: 0px;",this.$el.querySelector(".".concat(this.selectorCanvasWrap)).appendChild(this.gui.domElement)}}}),w=(n(535),n(46)),m=n(58),y=n.n(m),O=n(454),j=n(453),component=Object(w.a)(v,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{class:e.selectorCanvasWrap+"-container"},[n("v-col",{staticClass:"col-controls"},[n("div",{staticClass:"color-change-box"},[n("div",{staticClass:"color-change-box__red"}),e._v(" "),n("div",{staticClass:"color-change-box__green"}),e._v(" "),n("div",{staticClass:"color-change-box__blue"})])]),e._v(" "),n("v-col",{staticClass:"col-canvas",class:e.selectorCanvasWrap},[n("canvas",{staticClass:"webgl"})])],1)}),[],!1,null,"24a1fa92",null);t.default=component.exports;y()(component,{VCol:O.a,VRow:j.a})}}]);